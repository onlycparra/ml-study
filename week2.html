<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-07-20 Thu 16:43 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Machine Learning &#x2013; Week 2</title>
<meta name="author" content="Claudio Parra" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link rel="stylesheet" type="text/css" href="style.css" />
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Machine Learning &#x2013; Week 2</h1>
<p>
<a href="week1.html">Week 1</a> <a href="week3.html">Week 3</a>
</p>

<div id="outline-container-org91a25a9" class="outline-2">
<h2 id="org91a25a9"><span class="section-number-2">1.</span> Multivariate Linear Regression</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org6994280" class="outline-3">
<h3 id="org6994280"><span class="section-number-3">1.1.</span> Notation for Multiple Features</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li><p>
The set of training examples to be used is usually in the shape of a table where there are many <b>feature</b> columns and one <b>target</b> column (the price of apartments, in this example).
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">size</th>
<th scope="col" class="org-right">bedrooms</th>
<th scope="col" class="org-right">age</th>
<th scope="col" class="org-right">price</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1200</td>
<td class="org-right">3</td>
<td class="org-right">5</td>
<td class="org-right">9600</td>
</tr>

<tr>
<td class="org-right">1500</td>
<td class="org-right">4</td>
<td class="org-right">3</td>
<td class="org-right">12000</td>
</tr>

<tr>
<td class="org-right">960</td>
<td class="org-right">8</td>
<td class="org-right">2</td>
<td class="org-right">8000</td>
</tr>
</tbody>
</table>

<p>
Each training example in the table (each row) is said to be a <b>data point</b> \(d\). The \(i\)-th datapoint is denoted by \(d^{(i)}\). The array of features \(x\) are used by our <b>hypothesis</b> \(h_{\Theta}(x)\) to predict the target \(y\).
</p>

<p>
\[\text{\(i\)-th row data point}\rightarrow
  \quad
  d^{(i)}=\begin{bmatrix}
  x^{(i)} \\
  y^{(i)} \\
  \end{bmatrix}
  \quad
  \begin{split}
  &\leftarrow \text{features of \(i\)-th row} \\
  &\leftarrow \text{target of \(i\)-th row} \\
  \end{split}\]
</p>

<p>
then, the whole dataset \(D\) can be represented as an array of datapoints:
</p>

<p>
\[D = \begin{bmatrix}
  d^{(1)}, d^{(2)}, d^{(2)}, d^{(3)}, \dots
  \end{bmatrix}\]
</p></li>

<li><b>Extended list of features</b> of \(d^{(i)}\): For convenience, it is added an extra 1 at the beginning of the vector \(x\) so in the hypothesis function we have \(n\) parameters and \(n\) features.
This 1 matches with the <b>bias parameter</b> \(\Theta_0\).
\[x^{(i)} =
  \begin{bmatrix}
  x^{(i)}_0 = 1 \\
  x^{(i)}_1 \\
  x^{(i)}_2 \\
  x^{(i)}_3 \\
  x^{(i)}_4 \\
  \end{bmatrix}\]</li>

<li>Then, the hypothesis ends up just being the multiplication of the transposed vector of parameters \(\Theta^T\),  with the extended vector of features \(x\). (Remember that \(x_0=1\).)
\[\begin{split}
  h_{\Theta}(x) &\xrightarrow{\text{predicts}} y \\
  h_{\Theta}(x) &= \Theta_0x_0 + \Theta_1x_1 + \Theta_2x_2 + \Theta_3x_3 + \cdots \\
  h_{\Theta}(x) &= \begin{bmatrix}\Theta_0, \Theta_1, \Theta_2 \cdots\end{bmatrix} \times
                   \begin{bmatrix}x_0\\ x_1\\ x_2\\ \cdots\end{bmatrix} \\
  h_{\Theta}(x) &= \Theta^T \times x \\
  \end{split}\]</li>
</ul>
</div>
</div>
<div id="outline-container-orge189ef4" class="outline-3">
<h3 id="orge189ef4"><span class="section-number-3">1.2.</span> Gradient Descent (GD) for Multiple Variables</h3>
<div class="outline-text-3" id="text-1-2">
<ul class="org-ul">
<li>The idea is the same as with less variables. Given that the Cost function is \(\Theta^{T}x^{(i)}\), where \(x^{(i)}\) is the \(i\)-th training example, and \(x^{(i)}_{0} = 1\), to match \(\Theta_0\), then all the derivatives to update all the \(\Theta_{j}\) are easy to compute:
\[\begin{split}
  \Theta^{\text{new}}_j := \Theta^{\text{old}}_j -
  \textcolor{red}{\alpha}
  \textcolor{green}{\frac{\delta}{\delta\Theta_j} J(\Theta)}&\\
  %%
  \textcolor{green}{\frac{\delta}{\delta\Theta_j} J(\Theta)}& =
  \frac{1}{m}\sum^{m}_{i=1}\left(
  \big(
  h_{\Theta}(x^{(i)})-y^{(i)}
  \big)
  x^{(i)}_{j}\right)\\
  \end{split}\]
<ul class="org-ul">
<li>Green: Partial derivative of \(J\) with respect to \(\Theta_j\)</li>
<li>Red: Learning rate</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org0d550f3" class="outline-3">
<h3 id="org0d550f3"><span class="section-number-3">1.3.</span> GD: Feature Scaling and Normalization</h3>
<div class="outline-text-3" id="text-1-3">
</div>
<div id="outline-container-org3145422" class="outline-4">
<h4 id="org3145422"><span class="section-number-4">1.3.1.</span> Feature Scaling</h4>
<div class="outline-text-4" id="text-1-3-1">
<ul class="org-ul">
<li>Make sure the values of different features take values that range in similar values, this makes GD converge quickly. (this makes me thing on the disproportioned representation of skin surface in the brain, hands and face are huge, legs and backs are tiny.)</li>
<li>Different people have different takes in what is a sensible range, but the take-away is &ldquo;make sure they are in a kinda similar range&rdquo;.</li>
<li>This can be acheived by dividing every instance of a feature \(x_j\) by the max value seen in this feature in the whole dataset. This scales all values \(x_j\)s to the range \([0-1]\).</li>
</ul>
</div>
</div>
<div id="outline-container-org6df9d17" class="outline-4">
<h4 id="org6df9d17"><span class="section-number-4">1.3.2.</span> Mean Normalization</h4>
<div class="outline-text-4" id="text-1-3-2">
<ul class="org-ul">
<li>Making the values gravitate around 0, by replacing \(x_j\) with \(x_j - \mu_j\)</li>
<li>This does not apply to \(x_0\), because it needs to be \(1\).</li>
</ul>
</div>
</div>
<div id="outline-container-org52ffa2b" class="outline-4">
<h4 id="org52ffa2b"><span class="section-number-4">1.3.3.</span> Both together</h4>
<div class="outline-text-4" id="text-1-3-3">
<ul class="org-ul">
<li>The vid. talks about the denominator being either the range of values \((\text{max}(x_j)-\text{min}(x_j))\) or std deviation. Doing this you end up with values roughly between \([-0.5,0.5]\).
\[x^{\text{norm.}}_j := \frac{x_j - \mu_{j}}{\text{max}(x_j) - \text{min}(x_j)}\]</li>

<li>This denominator was not mentioned in the videos, but I think it is pretty much the same as before, the &ldquo;max&rdquo;, by which I am scaling, is also normalized. This leads to values in the range \([-1,1]\).
\[x^{\text{norm.}}_j := \frac{x_j - \mu_{j}}{\text{max}(x_j) \textcolor{blue}{- \mu_{j}}}\]</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org3d0888d" class="outline-3">
<h3 id="org3d0888d"><span class="section-number-3">1.4.</span> GD: Learning Rate \(\alpha\)</h3>
<div class="outline-text-3" id="text-1-4">
<ul class="org-ul">
<li>The point of learning is to find a \(\Theta^{\star}\) such that \(J(\Theta^{\star})\) is small <sup><a id="fnr.1" class="footref" href="#fn.1" role="doc-backlink">1</a></sup>, meaning that the hypothesis \(h_{\Theta^{\star}}(x)\) is, in average, not doing bad for any \(x\) you throw at it.</li>
<li>Supposedly, the more iterations of learning we accumulate (X axis in the right plot) we get smaller and smaller \(J(\Theta)\), which is the discrepancy between \(h_{\Theta}(x)\) and \(y\). In other words, we should be getting closer and closer to our \(\Theta^{\star}\).</li>
<li>Then, the point of \(\alpha\) is to determine how quickly we go in the direction of the gradient of \(J(\Theta)\). If my changes in \(\Theta\) (X axis of the left plot) are too abrupt, then, even if I go in the correct direction of the gradient (towards a valley), I can anyway overshoot (as seen by the red arrows in the left plot).</li>
<li>The effect is that as the training cummulates more and more iterations, we don&rsquo;t necessarily approach to a smaller \(J(\Theta)\) (as seen in the right plot).</li>
<li><p>
A good debugging technique is to plot \(J(\Theta\) (the right plot) as we refine \(\Theta\) with each iteration, so we can see whether it converges or not.
</p>

<div id="org96fb4fc" class="figure">
<p><img src="week2/learning_rate_a.png" alt="learning_rate_a.png" style="width: min(600px,100%);" />
</p>
</div></li>
<li><p>
Here an example with a smaller \(\alpha\). The steps are smaller, so it should take longer to to converge, but the chances of actually converging to our \(\Theta^{\star}\) without getting lost in the way, are better.
</p>

<div id="orgf32c451" class="figure">
<p><img src="week2/learning_rate_b.png" alt="learning_rate_b.png" style="width: min(600px,100%);" />
</p>
</div></li>
<li>An automatic convergence test could be &ldquo;if \(J(\Theta)\) is smaller than some \(\varepsilon\), then we say that \(J\) has converged&rdquo;. But it is often difficult to establish the actual value of such \(\varepsilon\).</li>

<li><p>
It has been demonstrated (by some ML nerds) that if \(\alpha\) is sufficiently small, then it is guaranteed that \(J(\Theta)\) <b>will decrease at every single iteration</b>. The cost of that is that the learning happens to be super slow. Here three examples that shows the feeling of what happens when we vary \(\alpha\):
</p>
<ul class="org-ul">
<li>A \(\alpha=0.1\)</li>
<li>B \(\alpha=0.01\)</li>
<li>C \(\alpha=1\)</li>
</ul>

<div id="org261bee2" class="figure">
<p><img src="week2/learning_rate_diff_alpha.png" alt="learning_rate_diff_alpha.png" style="width: min(600px,100%);" />
</p>
</div></li>
</ul>
</div>
</div>
<div id="outline-container-org77cf593" class="outline-3">
<h3 id="org77cf593"><span class="section-number-3">1.5.</span> Features and Polynomial Regression</h3>
<div class="outline-text-3" id="text-1-5">
<ul class="org-ul">
<li>Our hypothesis need not be linear (as shown below).
\[h_{\Theta}(x) =
  \Theta_0 +
  \Theta_1x_1 +
  \Theta_2x_2 +
  \Theta_3x_3 + \cdots\]</li>
<li>Sometimes we may think a quadratic or cubic hypothesis fits better the data.
\[h_{\Theta}(x) =
  \Theta_0 +
  \Theta_1\textcolor{red}{x} +
  \Theta_2\textcolor{red}{x^2} +
  \Theta_3\textcolor{red}{x^3} + \cdots\]</li>
<li>If we have only one original feature \(x_1\), we can create artificial features and then the rest of the algorithm is the same.
\[x_2 = x^2_1;\quad x_2 = x^3_1\]</li>
<li><p>
Or compose new features based on serveral originals. For example, if in a database of houses we have:
</p>
<ul class="org-ul">
<li>frontage length.</li>
<li>depth lenhth.</li>
</ul>
<p>
We may create a new feature <b>area</b> \(=\) frontage \(\times\) depth. And now my hypothesis may be in function of the area, rather than linear lengths.
</p></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org5831bc9" class="outline-2">
<h2 id="org5831bc9"><span class="section-number-2">2.</span> Computing Parameters Automatically</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org569e7e6" class="outline-3">
<h3 id="org569e7e6"><span class="section-number-3">2.1.</span> Normal Equation</h3>
<div class="outline-text-3" id="text-2-1">
<ul class="org-ul">
<li>Gradient descent is an iterative algorithm. An analytical approach is to solve for \(\Theta\).</li>
<li><p>
For example, take this dataset
</p>

<div id="orgfb94c14" class="figure">
<p><img src="week2/normal_fun_1.png" alt="normal_fun_1.png" style="width: min(600px,100%);" />
</p>
</div></li>
<li><p>
Then by computing \(\Theta = (X^TX)^{-1}X^Ty\), we get the best \(\Theta\).
</p>
<div class="org-src-container">
<pre class="src src-octave">  X <span style="color: #d33682; font-style: italic;">=</span> [<span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">2104</span> <span style="color: #6c71c4; font-weight: bold;">5</span> <span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">45</span><span style="color: #d33682; font-style: italic;">;</span>
       <span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">1416</span> <span style="color: #6c71c4; font-weight: bold;">3</span> <span style="color: #6c71c4; font-weight: bold;">2</span> <span style="color: #6c71c4; font-weight: bold;">40</span><span style="color: #d33682; font-style: italic;">;</span>
       <span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">1534</span> <span style="color: #6c71c4; font-weight: bold;">3</span> <span style="color: #6c71c4; font-weight: bold;">2</span> <span style="color: #6c71c4; font-weight: bold;">30</span><span style="color: #d33682; font-style: italic;">;</span>
       <span style="color: #6c71c4; font-weight: bold;">1</span>  <span style="color: #6c71c4; font-weight: bold;">852</span> <span style="color: #6c71c4; font-weight: bold;">2</span> <span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">36</span>]<span style="color: #d33682; font-style: italic;">;</span>
  y <span style="color: #d33682; font-style: italic;">=</span> [<span style="color: #6c71c4; font-weight: bold;">460</span><span style="color: #d33682; font-style: italic;">;</span>
       <span style="color: #6c71c4; font-weight: bold;">232</span><span style="color: #d33682; font-style: italic;">;</span>
       <span style="color: #6c71c4; font-weight: bold;">315</span><span style="color: #d33682; font-style: italic;">;</span>
       <span style="color: #6c71c4; font-weight: bold;">178</span>]<span style="color: #d33682; font-style: italic;">;</span>
  theta <span style="color: #d33682; font-style: italic;">=</span> pinv(X<span style="color: #d33682; font-style: italic;">'*</span>X)<span style="color: #d33682; font-style: italic;">*</span>X<span style="color: #d33682; font-style: italic;">'*</span>y
  <span style="color: #96A7A9; font-style: italic;">%</span>
  <span style="color: #96A7A9; font-style: italic;">% test it</span>
  x_1 <span style="color: #d33682; font-style: italic;">=</span> [<span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">2104</span> <span style="color: #6c71c4; font-weight: bold;">5</span> <span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">45</span>]<span style="color: #d33682; font-style: italic;">;</span>
  x_1 <span style="color: #d33682; font-style: italic;">*</span> theta
</pre>
</div>

<pre class="example">
theta =

   188.4003
     0.3866
   -56.1382
   -92.9673
    -3.7378
ans = 460.00
</pre></li>
</ul>
</div>
</div>

<div id="outline-container-org112f1c6" class="outline-3">
<h3 id="org112f1c6"><span class="section-number-3">2.2.</span> Gradient Descent vs Normal Equation</h3>
<div class="outline-text-3" id="text-2-2">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Gradient Descent</th>
<th scope="col" class="org-left">Normal Equation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Need to choose \(\alpha\)</td>
<td class="org-left">No \(\alpha\) to choose</td>
</tr>

<tr>
<td class="org-left">Iterative approach \(O(kn^2)\)</td>
<td class="org-left">No iteration needed. This is an analytical approach \(O(n^3)\)</td>
</tr>

<tr>
<td class="org-left">Works well even for huge number of n=features</td>
<td class="org-left">Need to compute the inverse of a \(n\times n\) matrix. Therefore, slow for large number of features</td>
</tr>
</tbody>
</table>

<p>
At \(n > 1,000,000\) it is probably the only option in a reasonably modern computer.
</p>
</div>
</div>
<div id="outline-container-orgc1b4e19" class="outline-3">
<h3 id="orgc1b4e19"><span class="section-number-3">2.3.</span> Non-invertible matrix</h3>
<div class="outline-text-3" id="text-2-3">
<ul class="org-ul">
<li>Some matrices are not invertible
<ul class="org-ul">
<li>Redundant features: reduce features, or use &rsquo;regularization&rsquo; (seen later).</li>
<li>\(m < n\): more features than training points.</li>
</ul></li>
<li>Ocave&rsquo;s <code>pinv()</code> is <b>pseudo-inverse</b>, which does &ldquo;the right thing&rdquo; even if the matrix has no inverse (???)</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org3ee1bfe" class="outline-2">
<h2 id="org3ee1bfe"><span class="section-number-2">3.</span> Octave Tutorial</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org53a6d1a" class="outline-3">
<h3 id="org53a6d1a"><span class="section-number-3">3.1.</span> Basic Operations</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Not equal is <code>~=</code>.
</p>
<div class="org-src-container">
<pre class="src src-octave"><span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #d33682; font-style: italic;">~=</span> <span style="color: #6c71c4; font-weight: bold;">2</span>
</pre>
</div>
<pre class="example">
ans = 1
</pre>


<p>
Logical operations AND and OR are like in C. but xor is a function.
</p>
<div class="org-src-container">
<pre class="src src-octave"><span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #d33682; font-style: italic;">&amp;&amp;</span> <span style="color: #6c71c4; font-weight: bold;">3</span> <span style="color: #d33682; font-style: italic;">||</span> xor(<span style="color: #6c71c4; font-weight: bold;">7</span><span style="color: #d33682; font-style: italic;">,</span><span style="color: #6c71c4; font-weight: bold;">0</span>)
</pre>
</div>
<pre class="example">
ans = 1
</pre>


<p>
Vector/matrix assignments use spaces for elements in the same row, and semicolons for going to the next row. The function <code>size()</code> returns the dimension of a matrix or vector. Transposition is denoted by one simple quotation mark.
</p>
<div class="org-src-container">
<pre class="src src-octave">row_vec <span style="color: #d33682; font-style: italic;">=</span> [<span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">2</span> <span style="color: #6c71c4; font-weight: bold;">3</span> <span style="color: #6c71c4; font-weight: bold;">4</span>]
col_vec <span style="color: #d33682; font-style: italic;">=</span> [<span style="color: #6c71c4; font-weight: bold;">1</span><span style="color: #d33682; font-style: italic;">;</span> <span style="color: #6c71c4; font-weight: bold;">2</span><span style="color: #d33682; font-style: italic;">;</span> <span style="color: #6c71c4; font-weight: bold;">3</span><span style="color: #d33682; font-style: italic;">;</span> <span style="color: #6c71c4; font-weight: bold;">4</span>]
A <span style="color: #d33682; font-style: italic;">=</span> [<span style="color: #6c71c4; font-weight: bold;">10</span> <span style="color: #6c71c4; font-weight: bold;">20</span> <span style="color: #6c71c4; font-weight: bold;">30</span><span style="color: #d33682; font-style: italic;">;</span>
     <span style="color: #6c71c4; font-weight: bold;">40</span> <span style="color: #6c71c4; font-weight: bold;">50</span> <span style="color: #6c71c4; font-weight: bold;">60</span>]
A_size <span style="color: #d33682; font-style: italic;">=</span> size(A)
A_cols <span style="color: #d33682; font-style: italic;">=</span> size(A<span style="color: #d33682; font-style: italic;">,</span><span style="color: #6c71c4; font-weight: bold;">1</span>)
A_rows <span style="color: #d33682; font-style: italic;">=</span> size(A<span style="color: #d33682; font-style: italic;">,</span><span style="color: #6c71c4; font-weight: bold;">2</span>)
[A_rows_alt<span style="color: #d33682; font-style: italic;">,</span> A_cols_alt] <span style="color: #d33682; font-style: italic;">=</span> size(A)
A_transp <span style="color: #d33682; font-style: italic;">=</span> A<span style="color: #d33682; font-style: italic;">'</span>
</pre>
</div>
<pre class="example" id="orgccc9ec7">
row_vec =

   1   2   3   4

col_vec =

   1
   2
   3
   4

A =

   10   20   30
   40   50   60

A_size =

   2   3

A_cols = 2
A_rows = 3
A_rows_alt = 2
A_cols_alt = 3
A_transp =

   10   40
   20   50
   30   60

</pre>

<p>
Finishing the line with semicolon doesn&rsquo;t show it in the output.
</p>
<div class="org-src-container">
<pre class="src src-octave">a <span style="color: #d33682; font-style: italic;">=</span> <span style="color: #6c71c4; font-weight: bold;">32</span>
x <span style="color: #d33682; font-style: italic;">=</span> <span style="color: #6c71c4; font-weight: bold;">43</span><span style="color: #d33682; font-style: italic;">;</span>
a<span style="color: #d33682; font-style: italic;">=</span><span style="color: #6c71c4; font-weight: bold;">1</span><span style="color: #d33682; font-style: italic;">,</span> b<span style="color: #d33682; font-style: italic;">=</span><span style="color: #6c71c4; font-weight: bold;">2</span><span style="color: #d33682; font-style: italic;">,</span> c<span style="color: #d33682; font-style: italic;">=</span><span style="color: #6c71c4; font-weight: bold;">3</span>
x<span style="color: #d33682; font-style: italic;">=</span><span style="color: #6c71c4; font-weight: bold;">7</span><span style="color: #d33682; font-style: italic;">;</span> y<span style="color: #d33682; font-style: italic;">=</span><span style="color: #6c71c4; font-weight: bold;">8</span><span style="color: #d33682; font-style: italic;">;</span> z<span style="color: #d33682; font-style: italic;">=</span><span style="color: #6c71c4; font-weight: bold;">9</span><span style="color: #d33682; font-style: italic;">;</span>
</pre>
</div>
<pre class="example">
a = 32
a = 1
b = 2
c = 3
</pre>


<p>
Show stuff on screen.
</p>
<div class="org-src-container">
<pre class="src src-octave">a <span style="color: #d33682; font-style: italic;">=</span> <span style="color: #6c71c4; font-weight: bold;">37</span><span style="color: #d33682; font-style: italic;">;</span>
disp(a)
printf(<span style="color: #2aa198;">'Two decimal points: %.2f'</span><span style="color: #d33682; font-style: italic;">,</span> a)<span style="color: #d33682; font-style: italic;">;</span>
</pre>
</div>
<pre class="example">
37
Two decimal points: 37.00
</pre>


<p>
Auto fill a vector <code>start:step:end</code> (inclusive).
</p>
<div class="org-src-container">
<pre class="src src-octave">D <span style="color: #d33682; font-style: italic;">=</span> <span style="color: #6c71c4; font-weight: bold;">5</span><span style="color: #d33682; font-style: italic;">:</span><span style="color: #6c71c4; font-weight: bold;">2</span><span style="color: #d33682; font-style: italic;">:</span><span style="color: #6c71c4; font-weight: bold;">13</span>
</pre>
</div>
<pre class="example">
D =

    5    7    9   11   13

</pre>
</div>
</div>

<div id="outline-container-orge213211" class="outline-3">
<h3 id="orge213211"><span class="section-number-3">3.2.</span> Scalar and Element-wise Operations</h3>
<div class="outline-text-3" id="text-3-2">
<div class="org-src-container">
<pre class="src src-octave"><span style="color: #96A7A9; font-style: italic;">% </span><span style="color: #96A7A9; font-style: italic;">Initialize matrix A and B, and scalar s</span>
A <span style="color: #d33682; font-style: italic;">=</span> [<span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">2</span> <span style="color: #6c71c4; font-weight: bold;">4</span><span style="color: #d33682; font-style: italic;">;</span> <span style="color: #6c71c4; font-weight: bold;">5</span> <span style="color: #6c71c4; font-weight: bold;">3</span> <span style="color: #6c71c4; font-weight: bold;">2</span>]
B <span style="color: #d33682; font-style: italic;">=</span> [<span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">3</span> <span style="color: #6c71c4; font-weight: bold;">4</span><span style="color: #d33682; font-style: italic;">;</span> <span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">1</span>]
s <span style="color: #d33682; font-style: italic;">=</span> <span style="color: #6c71c4; font-weight: bold;">2</span>
A_plus_B <span style="color: #d33682; font-style: italic;">=</span> A <span style="color: #d33682; font-style: italic;">+</span> B
A_minus_B <span style="color: #d33682; font-style: italic;">=</span> A <span style="color: #d33682; font-style: italic;">-</span> B
A_elem_mult_B <span style="color: #d33682; font-style: italic;">=</span> A <span style="color: #d33682; font-style: italic;">.*</span> B
one_elem_div_A <span style="color: #d33682; font-style: italic;">=</span> <span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #d33682; font-style: italic;">./</span> A
A_elem_square <span style="color: #d33682; font-style: italic;">=</span> A <span style="color: #d33682; font-style: italic;">.^</span> s
A_dot_s <span style="color: #d33682; font-style: italic;">=</span> A <span style="color: #d33682; font-style: italic;">*</span> s
A_div_s <span style="color: #d33682; font-style: italic;">=</span> A <span style="color: #d33682; font-style: italic;">/</span> s
A_plus_s <span style="color: #d33682; font-style: italic;">=</span> A <span style="color: #d33682; font-style: italic;">+</span> s
</pre>
</div>
<pre class="example" id="org1a3809d">
A =

   1   2   4
   5   3   2
B =

   1   3   4
   1   1   1
s = 2
A_plus_B =

   2   5   8
   6   4   3
A_minus_B =

   0  -1   0
   4   2   1
A_elem_mult_B =

    1    6   16
    5    3    2
one_elem_div_A =

   1.0000   0.5000   0.2500
   0.2000   0.3333   0.5000
A_elem_square =

    1    4   16
   25    9    4
A_dot_s =

    2    4    8
   10    6    4
A_div_s =

   0.5000   1.0000   2.0000
   2.5000   1.5000   1.0000
A_plus_s =

   3   4   6
   7   5   4
</pre>
</div>
</div>

<div id="outline-container-orgd22b06f" class="outline-3">
<h3 id="orgd22b06f"><span class="section-number-3">3.3.</span> Matrix Operations</h3>
<div class="outline-text-3" id="text-3-3">
<div class="org-src-container">
<pre class="src src-octave">A
B
max_elem_each_col_A <span style="color: #d33682; font-style: italic;">=</span> max(A) <span style="color: #96A7A9; font-style: italic;">% in matrix: max of each column. in vector: max</span>
A_less_than_B <span style="color: #d33682; font-style: italic;">=</span> A <span style="color: #d33682; font-style: italic;">&lt;</span> B        <span style="color: #96A7A9; font-style: italic;">% compare each element with its corresponding</span>
A_greater_than_3 <span style="color: #d33682; font-style: italic;">=</span> A <span style="color: #d33682; font-style: italic;">&gt;</span> <span style="color: #6c71c4; font-weight: bold;">3</span>     <span style="color: #96A7A9; font-style: italic;">% comapare all elements with a single scalar</span>
C <span style="color: #d33682; font-style: italic;">=</span> [<span style="color: #6c71c4; font-weight: bold;">2</span> <span style="color: #6c71c4; font-weight: bold;">3</span> <span style="color: #6c71c4; font-weight: bold;">9</span> <span style="color: #6c71c4; font-weight: bold;">8</span><span style="color: #d33682; font-style: italic;">;</span> <span style="color: #6c71c4; font-weight: bold;">0</span> <span style="color: #6c71c4; font-weight: bold;">9</span> <span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">4</span>]
[C_row_geq_5<span style="color: #d33682; font-style: italic;">,</span>C_col_geq_5] <span style="color: #d33682; font-style: italic;">=</span> find(C <span style="color: #d33682; font-style: italic;">&gt;=</span> <span style="color: #6c71c4; font-weight: bold;">5</span>) <span style="color: #96A7A9; font-style: italic;">% indices (row and col) of all elements that are at least 5</span>
</pre>
</div>
<pre class="example" id="orgf53c6f0">
A =

   1   2   4
   5   3   2
B =

   1   3   4
   1   1   1
max_elem_each_col_A =

   5   3   4
A_less_than_B =

  0  1  0
  0  0  0
A_greater_than_3 =

  0  0  1
  1  0  0
C =

   2   3   9   8
   0   9   1   4
C_row_geq_5 =

   2
   1
   1

C_col_geq_5 =

   2
   3
   4
col_wise_sum =

    2   12   10   12
row_wise_sum =

   22
   14
</pre>
</div>
</div>

<div id="outline-container-orgbdfc55b" class="outline-3">
<h3 id="orgbdfc55b"><span class="section-number-3">3.4.</span> Indexing and Slicing Matrices</h3>
<div class="outline-text-3" id="text-3-4">
<div class="org-src-container">
<pre class="src src-octave">A <span style="color: #d33682; font-style: italic;">=</span> [<span style="color: #6c71c4; font-weight: bold;">11</span> <span style="color: #6c71c4; font-weight: bold;">12</span> <span style="color: #6c71c4; font-weight: bold;">13</span> <span style="color: #6c71c4; font-weight: bold;">14</span> <span style="color: #6c71c4; font-weight: bold;">15</span> <span style="color: #6c71c4; font-weight: bold;">16</span><span style="color: #d33682; font-style: italic;">;</span>
     <span style="color: #6c71c4; font-weight: bold;">21</span> <span style="color: #6c71c4; font-weight: bold;">22</span> <span style="color: #6c71c4; font-weight: bold;">23</span> <span style="color: #6c71c4; font-weight: bold;">24</span> <span style="color: #6c71c4; font-weight: bold;">25</span> <span style="color: #6c71c4; font-weight: bold;">26</span><span style="color: #d33682; font-style: italic;">;</span>
     <span style="color: #6c71c4; font-weight: bold;">31</span> <span style="color: #6c71c4; font-weight: bold;">32</span> <span style="color: #6c71c4; font-weight: bold;">33</span> <span style="color: #6c71c4; font-weight: bold;">34</span> <span style="color: #6c71c4; font-weight: bold;">35</span> <span style="color: #6c71c4; font-weight: bold;">36</span><span style="color: #d33682; font-style: italic;">;</span>
     <span style="color: #6c71c4; font-weight: bold;">41</span> <span style="color: #6c71c4; font-weight: bold;">42</span> <span style="color: #6c71c4; font-weight: bold;">43</span> <span style="color: #6c71c4; font-weight: bold;">44</span> <span style="color: #6c71c4; font-weight: bold;">45</span> <span style="color: #6c71c4; font-weight: bold;">46</span>]
one_elem <span style="color: #d33682; font-style: italic;">=</span> A(<span style="color: #6c71c4; font-weight: bold;">2</span><span style="color: #d33682; font-style: italic;">,</span><span style="color: #6c71c4; font-weight: bold;">4</span>) <span style="color: #96A7A9; font-style: italic;">% get a single element in row 2 and column 4</span>
one_col <span style="color: #d33682; font-style: italic;">=</span> A(<span style="color: #6c71c4; font-weight: bold;">3</span>)    <span style="color: #96A7A9; font-style: italic;">% get a column</span>


</pre>
</div>
<pre class="example">
A =

   11   12   13   14   15   16
   21   22   23   24   25   26
   31   32   33   34   35   36
   41   42   43   44   45   46
one_elem = 24
one_col = 31
ans = 6
</pre>


<p>
To select a range of elements we can use the <code>m:n</code> notation. You can replace <code>n</code> with <code>end</code>. This allow us to extract submatrices, columns and rows.
</p>
<dl class="org-dl">
<dt><code>m:n</code>  </dt><dd>&ldquo;everything from m to n&rdquo; (including elements <code>m</code> and <code>n</code>)</dd>
<dt><code>1:n</code>  </dt><dd>&ldquo;all from the beginning to n&rdquo;</dd>
<dt><code>m:end</code></dt><dd>&ldquo;all from m to the end&rdquo;</dd>
<dt><code>1:end</code></dt><dd>&ldquo;all from beginning to end&rdquo;. You can also use the shorthand <code>:</code></dd>
</dl>

<p>
Get a single element
</p>
<div class="org-src-container">
<pre class="src src-octave">elem <span style="color: #d33682; font-style: italic;">=</span> A(<span style="color: #6c71c4; font-weight: bold;">4</span><span style="color: #d33682; font-style: italic;">,</span><span style="color: #6c71c4; font-weight: bold;">3</span>)
</pre>
</div>
<pre class="example">
elem = 43
</pre>


<p>
Get a submatrix defining row range (from 2 to 4) and column range (from 3 to 5).
</p>
<div class="org-src-container">
<pre class="src src-octave">sub_matrix <span style="color: #d33682; font-style: italic;">=</span> A(<span style="color: #6c71c4; font-weight: bold;">2</span><span style="color: #d33682; font-style: italic;">:</span><span style="color: #6c71c4; font-weight: bold;">4</span><span style="color: #d33682; font-style: italic;">,</span><span style="color: #6c71c4; font-weight: bold;">3</span><span style="color: #d33682; font-style: italic;">:</span><span style="color: #6c71c4; font-weight: bold;">5</span>)
</pre>
</div>
<pre class="example">
sub_matrix =

   23   24   25
   33   34   35
   43   44   45
</pre>


<p>
Get the lower right submatrix.
</p>
<div class="org-src-container">
<pre class="src src-octave">sub_matrix_lower_right <span style="color: #d33682; font-style: italic;">=</span> A(<span style="color: #6c71c4; font-weight: bold;">2</span><span style="color: #d33682; font-style: italic;">:</span>end<span style="color: #d33682; font-style: italic;">,</span><span style="color: #6c71c4; font-weight: bold;">4</span><span style="color: #d33682; font-style: italic;">:</span>end)
</pre>
</div>
<pre class="example">
sub_matrix_lower_right =

   24   25   26
   34   35   36
   44   45   46
</pre>


<p>
Get the 3rd column and 4th row.
</p>
<div class="org-src-container">
<pre class="src src-octave">my_col <span style="color: #d33682; font-style: italic;">=</span> A(<span style="color: #d33682; font-style: italic;">:,</span><span style="color: #6c71c4; font-weight: bold;">3</span>)
my_row <span style="color: #d33682; font-style: italic;">=</span> A(<span style="color: #6c71c4; font-weight: bold;">4</span><span style="color: #d33682; font-style: italic;">,:</span>)
</pre>
</div>
<pre class="example">
my_col =

   13
   23
   33
   43
my_row =

   41   42   43   44   45   46
</pre>


<p>
We can pick several non-contiguous elements too with the <code>[a b ...]</code> notation. For example, let&rsquo;s extract the corners of the matrix <code>A</code>.
</p>
<div class="org-src-container">
<pre class="src src-octave">corners <span style="color: #d33682; font-style: italic;">=</span> A([<span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">4</span>]<span style="color: #d33682; font-style: italic;">,</span>[<span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">6</span>])
</pre>
</div>
<pre class="example">
corners =

   11   16
   41   46
</pre>


<p>
Put all elements of a <b>matrix</b> as a single <b>array</b> with the special notation <code>A(:)</code>. Note that this is different from <code>A(:,:)</code>
</p>
<div class="org-src-container">
<pre class="src src-octave">corners(<span style="color: #d33682; font-style: italic;">:</span>)   <span style="color: #96A7A9; font-style: italic;">% this reshapes the matrix as an array</span>
corners(<span style="color: #d33682; font-style: italic;">:,:</span>) <span style="color: #96A7A9; font-style: italic;">% this simply selects everything in the matrix preserving its shape</span>
</pre>
</div>
<pre class="example" id="orgd14f94e">
ans =

   11
   41
   16
   46
ans =

   11   16
   41   46
</pre>
</div>
</div>

<div id="outline-container-orgc28d0d2" class="outline-3">
<h3 id="orgc28d0d2"><span class="section-number-3">3.5.</span> Moving Data Around</h3>
<div class="outline-text-3" id="text-3-5">
<p>
Pasting matrices together
</p>
<div class="org-src-container">
<pre class="src src-octave">One <span style="color: #d33682; font-style: italic;">=</span> ones(<span style="color: #6c71c4; font-weight: bold;">2</span><span style="color: #d33682; font-style: italic;">,</span><span style="color: #6c71c4; font-weight: bold;">2</span>)
Two <span style="color: #d33682; font-style: italic;">=</span> <span style="color: #6c71c4; font-weight: bold;">2</span><span style="color: #d33682; font-style: italic;">*</span>One
[One Two]
[One<span style="color: #d33682; font-style: italic;">;</span> Two]
</pre>
</div>
<pre class="example" id="org27c8d72">
One =

   1   1
   1   1
Two =

   2   2
   2   2
ans =

   1   1   2   2
   1   1   2   2
ans =

   1   1
   1   1
   2   2
   2   2
</pre>

<p>
Show the current working directory, and list its content in one column (<code>-1</code>).
</p>
<div class="org-src-container">
<pre class="src src-octave">pwd
ls <span style="color: #d33682; font-style: italic;">-</span><span style="color: #6c71c4; font-weight: bold;">1</span>
</pre>
</div>
<pre class="example">
ans = /home/claudio/repos/machine-learning/week2
learning_rate_a.png
learning_rate_b.png
learning_rate_diff_alpha.png
my_dataset.txt
my_vars.bin
my_vars.txt
normal_fun_1.png
normal_plot.png
</pre>


<p>
Let&rsquo;s consider the file <code>my_dataset.txt</code> with some data (this block is bash, not octave).
</p>
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #b58900; font-style: italic;">cat</span> my_dataset.txt
</pre>
</div>
<pre class="example">
2104 5 1 45 460
1416 3 2 40 232
1534 3 2 30 315
 852 2 1 36 178
</pre>


<p>
To load that file in Octave, use the function <code>load()</code>.
</p>
<div class="org-src-container">
<pre class="src src-octave">data <span style="color: #d33682; font-style: italic;">=</span> load(<span style="color: #2aa198;">'my_dataset.txt'</span>)
size(data)
<span style="color: #96A7A9; font-style: italic;">% </span><span style="color: #96A7A9; font-style: italic;">add a column of ones at the left. 4 == size(data,1)</span>
X <span style="color: #d33682; font-style: italic;">=</span> [  ones(size(data<span style="color: #d33682; font-style: italic;">,</span><span style="color: #6c71c4; font-weight: bold;">1</span>)<span style="color: #d33682; font-style: italic;">,</span><span style="color: #6c71c4; font-weight: bold;">1</span>)  <span style="color: #d33682; font-style: italic;">,</span>  data(<span style="color: #d33682; font-style: italic;">:,</span><span style="color: #6c71c4; font-weight: bold;">1</span><span style="color: #d33682; font-style: italic;">:</span>(end<span style="color: #d33682; font-style: italic;">-</span><span style="color: #6c71c4; font-weight: bold;">1</span>))  ]
y <span style="color: #d33682; font-style: italic;">=</span> data(<span style="color: #d33682; font-style: italic;">:,</span>end)
</pre>
</div>
<pre class="example" id="orgcf63a95">
data =

   2104      5      1     45    460
   1416      3      2     40    232
   1534      3      2     30    315
    852      2      1     36    178
ans =

   4   5
X =

      1   2104      5      1     45
      1   1416      3      2     40
      1   1534      3      2     30
      1    852      2      1     36
y =

   460
   232
   315
   178
</pre>
</div>
</div>

<div id="outline-container-org5892c2b" class="outline-3">
<h3 id="org5892c2b"><span class="section-number-3">3.6.</span> Show Variables and Save them to Files</h3>
<div class="outline-text-3" id="text-3-6">
<p>
To check the defined variables, use the command <code>who</code> or <code>whos</code> (for detailed view)
</p>
<div class="org-src-container">
<pre class="src src-octave">a <span style="color: #d33682; font-style: italic;">=</span> <span style="color: #6c71c4; font-weight: bold;">3</span><span style="color: #d33682; font-style: italic;">;</span>
b <span style="color: #d33682; font-style: italic;">=</span> [<span style="color: #6c71c4; font-weight: bold;">4</span> <span style="color: #6c71c4; font-weight: bold;">5</span> <span style="color: #6c71c4; font-weight: bold;">6</span>]<span style="color: #d33682; font-style: italic;">;</span>
C <span style="color: #d33682; font-style: italic;">=</span> [<span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">2</span> <span style="color: #6c71c4; font-weight: bold;">3</span> <span style="color: #6c71c4; font-weight: bold;">4</span> <span style="color: #6c71c4; font-weight: bold;">5</span><span style="color: #d33682; font-style: italic;">;</span> <span style="color: #6c71c4; font-weight: bold;">6</span> <span style="color: #6c71c4; font-weight: bold;">7</span> <span style="color: #6c71c4; font-weight: bold;">8</span> <span style="color: #6c71c4; font-weight: bold;">9</span> <span style="color: #6c71c4; font-weight: bold;">0</span>]<span style="color: #d33682; font-style: italic;">;</span>
who
whos
</pre>
</div>
<pre class="example" id="org3f8a086">
Variables visible from the current scope:

C    a    ans  b
Variables visible from the current scope:

variables in scope: top scope

  Attr   Name        Size                     Bytes  Class
  ====   ====        ====                     =====  =====
         C           2x5                         80  double
         a           1x1                          8  double
         ans         1x13                        13  char
         b           1x3                         24  double

Total is 27 elements using 125 bytes
</pre>

<p>
Save variables to a file
</p>
<div class="org-src-container">
<pre class="src src-octave">save(<span style="color: #2aa198;">'my_vars.txt'</span><span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'a'</span><span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'b'</span><span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'C'</span>)
save(<span style="color: #2aa198;">'-binary'</span><span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'my_vars.bin'</span><span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'a'</span><span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'b'</span><span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'C'</span>)
</pre>
</div>
<p>
Now, if in bash (not Octave) we check the files
</p>
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #b58900; font-style: italic;">ls</span> -l my_vars.*
<span style="color: #b58900; font-style: italic;">echo</span> <span style="color: #2aa198;">"&gt;&gt;&gt;&gt; ASCII file:"</span>
<span style="color: #b58900; font-style: italic;">cat</span> my_vars.txt
<span style="color: #b58900; font-style: italic;">echo</span> <span style="color: #2aa198;">"&gt;&gt;&gt;&gt; Binary file:"</span>
hexdump -C my_vars.bin
</pre>
</div>
<pre class="example" id="org7a6cbe1">
-rw-r--r--. 1 claudio claudio 213 Jul 20 03:07 my_vars.bin
-rw-r--r--. 1 claudio claudio 233 Jul 20 03:07 my_vars.txt
&gt;&gt;&gt;&gt; ASCII file:
# Created by Octave 7.3.0, Thu Jul 20 03:07:03 2023 PDT &lt;claudio@ncc91277&gt;
# name: a
# type: scalar
3


# name: b
# type: matrix
# rows: 1
# columns: 3
 4 5 6


# name: C
# type: matrix
# rows: 2
# columns: 5
 1 2 3 4 5
 6 7 8 9 0
&gt;&gt;&gt;&gt; Binary file:
00000000  4f 63 74 61 76 65 2d 31  2d 4c 00 01 00 00 00 61  |Octave-1-L.....a|
00000010  00 00 00 00 00 ff 06 00  00 00 73 63 61 6c 61 72  |..........scalar|
00000020  07 00 00 00 00 00 00 08  40 01 00 00 00 62 00 00  |........@....b..|
00000030  00 00 00 ff 06 00 00 00  6d 61 74 72 69 78 fe ff  |........matrix..|
00000040  ff ff 01 00 00 00 03 00  00 00 07 00 00 00 00 00  |................|
00000050  00 10 40 00 00 00 00 00  00 14 40 00 00 00 00 00  |..@.......@.....|
00000060  00 18 40 01 00 00 00 43  00 00 00 00 00 ff 06 00  |..@....C........|
00000070  00 00 6d 61 74 72 69 78  fe ff ff ff 02 00 00 00  |..matrix........|
00000080  05 00 00 00 07 00 00 00  00 00 00 f0 3f 00 00 00  |............?...|
00000090  00 00 00 18 40 00 00 00  00 00 00 00 40 00 00 00  |....@.......@...|
000000a0  00 00 00 1c 40 00 00 00  00 00 00 08 40 00 00 00  |....@.......@...|
000000b0  00 00 00 20 40 00 00 00  00 00 00 10 40 00 00 00  |... @.......@...|
000000c0  00 00 00 22 40 00 00 00  00 00 00 14 40 00 00 00  |..."@.......@...|
000000d0  00 00 00 00 00                                    |.....|
000000d5
</pre>
</div>
</div>

<div id="outline-container-org7efae4b" class="outline-3">
<h3 id="org7efae4b"><span class="section-number-3">3.7.</span> Computing Data</h3>
<div class="outline-text-3" id="text-3-7">
<p>
Adding up rows and columns
</p>
<div class="org-src-container">
<pre class="src src-octave">A <span style="color: #d33682; font-style: italic;">=</span> [<span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">2</span> <span style="color: #6c71c4; font-weight: bold;">4</span> <span style="color: #6c71c4; font-weight: bold;">5</span><span style="color: #d33682; font-style: italic;">;</span> <span style="color: #6c71c4; font-weight: bold;">7</span> <span style="color: #6c71c4; font-weight: bold;">8</span> <span style="color: #6c71c4; font-weight: bold;">3</span> <span style="color: #6c71c4; font-weight: bold;">2</span>]
B <span style="color: #d33682; font-style: italic;">=</span> [<span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">3</span> <span style="color: #6c71c4; font-weight: bold;">4</span> <span style="color: #6c71c4; font-weight: bold;">7</span><span style="color: #d33682; font-style: italic;">;</span> <span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">1</span>]
C <span style="color: #d33682; font-style: italic;">=</span> [<span style="color: #6c71c4; font-weight: bold;">2</span> <span style="color: #6c71c4; font-weight: bold;">3</span> <span style="color: #6c71c4; font-weight: bold;">9</span> <span style="color: #6c71c4; font-weight: bold;">8</span><span style="color: #d33682; font-style: italic;">;</span> <span style="color: #6c71c4; font-weight: bold;">0</span> <span style="color: #6c71c4; font-weight: bold;">9</span> <span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">4</span>]
s <span style="color: #d33682; font-style: italic;">=</span> <span style="color: #6c71c4; font-weight: bold;">2</span>
col_wise_sum_A <span style="color: #d33682; font-style: italic;">=</span> sum(A<span style="color: #d33682; font-style: italic;">,</span><span style="color: #6c71c4; font-weight: bold;">1</span>)  <span style="color: #96A7A9; font-style: italic;">% adds up all elements of each column</span>
row_wise_sum_C <span style="color: #d33682; font-style: italic;">=</span> sum(C<span style="color: #d33682; font-style: italic;">,</span><span style="color: #6c71c4; font-weight: bold;">2</span>)  <span style="color: #96A7A9; font-style: italic;">% adds up all elements of each row</span>
</pre>
</div>
<pre class="example" id="orgdc8c054">
A =

   1   2   4   5
   7   8   3   2
B =

   1   3   4   7
   1   1   1   1
C =

   2   3   9   8
   0   9   1   4
s = 2
col_wise_sum_A =

    8   10    7    7
row_wise_sum_C =

   22
   14
</pre>

<p>
Flip matrix upside down
</p>
<div class="org-src-container">
<pre class="src src-octave">D <span style="color: #d33682; font-style: italic;">=</span> [<span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">2</span> <span style="color: #6c71c4; font-weight: bold;">3</span>]<span style="color: #d33682; font-style: italic;">'</span> <span style="color: #d33682; font-style: italic;">*</span> [<span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">2</span> <span style="color: #6c71c4; font-weight: bold;">3</span>]
upside_down_D <span style="color: #d33682; font-style: italic;">=</span> flipud(D)
</pre>
</div>
<pre class="example" id="org5a6cac6">
D =

   1   2   3
   2   4   6
   3   6   9
upside_down_D =

   3   6   9
   2   4   6
   1   2   3
</pre>

<p>
Pseudo-inverse
</p>
<div class="org-src-container">
<pre class="src src-octave">X <span style="color: #d33682; font-style: italic;">=</span> [<span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">2</span> <span style="color: #6c71c4; font-weight: bold;">3</span><span style="color: #d33682; font-style: italic;">;</span> <span style="color: #6c71c4; font-weight: bold;">3</span> <span style="color: #6c71c4; font-weight: bold;">0</span> <span style="color: #6c71c4; font-weight: bold;">0</span><span style="color: #d33682; font-style: italic;">;</span> <span style="color: #6c71c4; font-weight: bold;">4</span> <span style="color: #6c71c4; font-weight: bold;">5</span> <span style="color: #6c71c4; font-weight: bold;">2</span>]
pseudo_inverse <span style="color: #d33682; font-style: italic;">=</span> pinv(X)
</pre>
</div>
<pre class="example" id="org1e1eb83">
X =

   1   2   3
   3   0   0
   4   5   2
pseudo_inverse =

  -6.3596e-17   3.3333e-01  -6.3252e-17
  -1.8182e-01  -3.0303e-01   2.7273e-01
   4.5455e-01   9.0909e-02  -1.8182e-01
</pre>
</div>
</div>

<div id="outline-container-orgdf87385" class="outline-3">
<h3 id="orgdf87385"><span class="section-number-3">3.8.</span> Plotting Data</h3>
<div class="outline-text-3" id="text-3-8">
<div class="org-src-container">
<pre class="src src-octave">X <span style="color: #d33682; font-style: italic;">=</span> <span style="color: #d33682; font-style: italic;">-</span><span style="color: #6c71c4; font-weight: bold;">10</span> <span style="color: #d33682; font-style: italic;">+</span> sqrt(<span style="color: #6c71c4; font-weight: bold;">10</span>)<span style="color: #d33682; font-style: italic;">*</span>randn(<span style="color: #6c71c4; font-weight: bold;">1</span><span style="color: #d33682; font-style: italic;">,</span><span style="color: #6c71c4; font-weight: bold;">10000</span>)<span style="color: #d33682; font-style: italic;">;</span> <span style="color: #96A7A9; font-style: italic;">% random variable with mean=-10, and variance=10.</span>
hist(X<span style="color: #d33682; font-style: italic;">,</span> <span style="color: #6c71c4; font-weight: bold;">30</span>)<span style="color: #d33682; font-style: italic;">;</span> <span style="color: #96A7A9; font-style: italic;">% plot its histogram with 30 bins</span>
xlabel(<span style="color: #2aa198;">'Value'</span>)<span style="color: #d33682; font-style: italic;">;</span> ylabel(<span style="color: #2aa198;">'Count'</span>)<span style="color: #d33682; font-style: italic;">;</span> title(<span style="color: #2aa198;">'My Histogram (30 bins)'</span>)<span style="color: #d33682; font-style: italic;">;</span> legend(<span style="color: #2aa198;">'Population A'</span>)<span style="color: #d33682; font-style: italic;">;</span>
<span style="color: #96A7A9; font-style: italic;">% </span><span style="color: #96A7A9; font-style: italic;">Configure and save image</span>
set(gca<span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'box'</span><span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'on'</span>)<span style="color: #d33682; font-style: italic;">;</span> set(gcf<span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'paperposition'</span><span style="color: #d33682; font-style: italic;">,</span> [<span style="color: #6c71c4; font-weight: bold;">0</span> <span style="color: #6c71c4; font-weight: bold;">0</span> <span style="color: #6c71c4; font-weight: bold;">8</span> <span style="color: #6c71c4; font-weight: bold;">4</span>]<span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'visible'</span><span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'off'</span>)<span style="color: #d33682; font-style: italic;">;</span> <span style="color: #96A7A9; font-style: italic;">% config axis and figure</span>
print(<span style="color: #2aa198;">'normal_plot.png'</span><span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'-dpng'</span><span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'-r300'</span>)<span style="color: #d33682; font-style: italic;">;</span>
</pre>
</div>

<div id="org1a71990" class="figure">
<p><img src="week2/normal_plot.png" alt="normal_plot.png" style="width: min(800px,100%);" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-octave">t <span style="color: #d33682; font-style: italic;">=</span> [<span style="color: #6c71c4; font-weight: bold;">0</span><span style="color: #d33682; font-style: italic;">:</span><span style="color: #6c71c4; font-weight: bold;">0.005</span><span style="color: #d33682; font-style: italic;">:</span><span style="color: #6c71c4; font-weight: bold;">0.995</span>]<span style="color: #d33682; font-style: italic;">;</span> <span style="color: #96A7A9; font-style: italic;">% x axis range from 0 to almost 1</span>
y1 <span style="color: #d33682; font-style: italic;">=</span> sin(<span style="color: #6c71c4; font-weight: bold;">8</span><span style="color: #d33682; font-style: italic;">*</span>pi<span style="color: #d33682; font-style: italic;">*</span>t)<span style="color: #d33682; font-style: italic;">;</span> y2 <span style="color: #d33682; font-style: italic;">=</span> cos(<span style="color: #6c71c4; font-weight: bold;">2.1</span><span style="color: #d33682; font-style: italic;">*</span>pi<span style="color: #d33682; font-style: italic;">*</span>(t<span style="color: #d33682; font-style: italic;">-</span><span style="color: #6c71c4; font-weight: bold;">0.15</span>))<span style="color: #d33682; font-style: italic;">;</span>
hold on<span style="color: #d33682; font-style: italic;">;</span>
plot(t<span style="color: #d33682; font-style: italic;">,</span> y1<span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'g'</span>)<span style="color: #d33682; font-style: italic;">;</span> plot(t<span style="color: #d33682; font-style: italic;">,</span> y2<span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'r'</span>)<span style="color: #d33682; font-style: italic;">;</span>
xlabel(<span style="color: #2aa198;">'Time'</span>)<span style="color: #d33682; font-style: italic;">;</span> ylabel(<span style="color: #2aa198;">'Value'</span>)<span style="color: #d33682; font-style: italic;">;</span> title(<span style="color: #2aa198;">'My Plot'</span>)<span style="color: #d33682; font-style: italic;">;</span> legend(<span style="color: #2aa198;">'sin(8*pi*t)'</span><span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'cos(2.1*pi*t)'</span>)
<span style="color: #96A7A9; font-style: italic;">% </span><span style="color: #96A7A9; font-style: italic;">Configure and save image</span>
set(gca<span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'box'</span><span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'on'</span>)<span style="color: #d33682; font-style: italic;">;</span> set(gcf<span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'paperposition'</span><span style="color: #d33682; font-style: italic;">,</span> [<span style="color: #6c71c4; font-weight: bold;">0</span> <span style="color: #6c71c4; font-weight: bold;">0</span> <span style="color: #6c71c4; font-weight: bold;">8</span> <span style="color: #6c71c4; font-weight: bold;">4</span>]<span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'visible'</span><span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'off'</span>)<span style="color: #d33682; font-style: italic;">;</span>
print(<span style="color: #2aa198;">'plot_sin.png'</span><span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'-dpng'</span><span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'-r300'</span>)<span style="color: #d33682; font-style: italic;">;</span>
</pre>
</div>

<div id="org5e2ae25" class="figure">
<p><img src="week2/plot_sin.png" alt="plot_sin.png" style="width: min(800px,100%);" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-octave">t <span style="color: #d33682; font-style: italic;">=</span> [<span style="color: #6c71c4; font-weight: bold;">0</span><span style="color: #d33682; font-style: italic;">:</span><span style="color: #6c71c4; font-weight: bold;">0.01</span><span style="color: #d33682; font-style: italic;">:</span><span style="color: #6c71c4; font-weight: bold;">0.99</span>]<span style="color: #d33682; font-style: italic;">;</span> <span style="color: #96A7A9; font-style: italic;">% x axis range from 0 to 1</span>
y1<span style="color: #d33682; font-style: italic;">=</span>sin(<span style="color: #6c71c4; font-weight: bold;">3</span><span style="color: #d33682; font-style: italic;">*</span>pi<span style="color: #d33682; font-style: italic;">*</span>t)<span style="color: #d33682; font-style: italic;">;</span> y2<span style="color: #d33682; font-style: italic;">=</span>cos(<span style="color: #6c71c4; font-weight: bold;">2.1</span><span style="color: #d33682; font-style: italic;">*</span>pi<span style="color: #d33682; font-style: italic;">*</span>t)<span style="color: #d33682; font-style: italic;">-</span><span style="color: #6c71c4; font-weight: bold;">2</span><span style="color: #d33682; font-style: italic;">;</span> y3<span style="color: #d33682; font-style: italic;">=</span>cos(<span style="color: #6c71c4; font-weight: bold;">7</span><span style="color: #d33682; font-style: italic;">*</span>pi<span style="color: #d33682; font-style: italic;">*</span>(t<span style="color: #d33682; font-style: italic;">-</span><span style="color: #6c71c4; font-weight: bold;">0.2</span>))<span style="color: #d33682; font-style: italic;">+</span><span style="color: #6c71c4; font-weight: bold;">3.13</span><span style="color: #d33682; font-style: italic;">;</span>
map <span style="color: #d33682; font-style: italic;">=</span> (y1<span style="color: #d33682; font-style: italic;">'</span> <span style="color: #d33682; font-style: italic;">*</span> y2) <span style="color: #d33682; font-style: italic;">*</span> (eye(size(t)) <span style="color: #d33682; font-style: italic;">*</span> y3<span style="color: #d33682; font-style: italic;">'</span>) <span style="color: #d33682; font-style: italic;">.*</span> (y1<span style="color: #d33682; font-style: italic;">+</span>y2)<span style="color: #d33682; font-style: italic;">;</span>
hold on<span style="color: #d33682; font-style: italic;">;</span>
imagesc(map)<span style="color: #d33682; font-style: italic;">;</span> colorbar<span style="color: #d33682; font-style: italic;">;</span> colormap(<span style="color: #2aa198;">'gray'</span>)<span style="color: #d33682; font-style: italic;">;</span>
axis([<span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">100</span> <span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">100</span>])d
xlabel(<span style="color: #2aa198;">'X axis'</span>)<span style="color: #d33682; font-style: italic;">;</span> ylabel(<span style="color: #2aa198;">'Y axis'</span>)<span style="color: #d33682; font-style: italic;">;</span> title(<span style="color: #2aa198;">'Heatmap'</span>)<span style="color: #d33682; font-style: italic;">;</span>
<span style="color: #96A7A9; font-style: italic;">% </span><span style="color: #96A7A9; font-style: italic;">Configure and save image</span>
set(gca<span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'box'</span><span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'on'</span>)<span style="color: #d33682; font-style: italic;">;</span> set(gcf<span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'paperposition'</span><span style="color: #d33682; font-style: italic;">,</span> [<span style="color: #6c71c4; font-weight: bold;">0</span> <span style="color: #6c71c4; font-weight: bold;">0</span> <span style="color: #6c71c4; font-weight: bold;">8</span> <span style="color: #6c71c4; font-weight: bold;">6</span>]<span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'visible'</span><span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'off'</span>)<span style="color: #d33682; font-style: italic;">;</span>
print(<span style="color: #2aa198;">'map_wave.png'</span><span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'-dpng'</span><span style="color: #d33682; font-style: italic;">,</span> <span style="color: #2aa198;">'-r300'</span>)<span style="color: #d33682; font-style: italic;">;</span>
</pre>
</div>

<div id="org639ee3a" class="figure">
<p><img src="week2/map_wave.png" alt="map_wave.png" style="width: min(800px,100%);" />
</p>
</div>
</div>
</div>

<div id="outline-container-org5027b68" class="outline-3">
<h3 id="org5027b68"><span class="section-number-3">3.9.</span> Control Statements</h3>
<div class="outline-text-3" id="text-3-9">
</div>
<div id="outline-container-org4d2c3ac" class="outline-4">
<h4 id="org4d2c3ac"><span class="section-number-4">3.9.1.</span> Loops and Conditionals</h4>
<div class="outline-text-4" id="text-3-9-1">
<p>
For loops
</p>
<div class="org-src-container">
<pre class="src src-octave">v <span style="color: #d33682; font-style: italic;">=</span> zeros(<span style="color: #6c71c4; font-weight: bold;">1</span><span style="color: #d33682; font-style: italic;">,</span><span style="color: #6c71c4; font-weight: bold;">10</span>)
<span style="color: #859900; font-weight: bold;">for</span> i<span style="color: #d33682; font-style: italic;">=</span><span style="color: #6c71c4; font-weight: bold;">1</span><span style="color: #d33682; font-style: italic;">:</span><span style="color: #6c71c4; font-weight: bold;">7</span><span style="color: #d33682; font-style: italic;">,</span>
  v(i) <span style="color: #d33682; font-style: italic;">=</span> <span style="color: #6c71c4; font-weight: bold;">2</span><span style="color: #d33682; font-style: italic;">^</span>i<span style="color: #d33682; font-style: italic;">;</span>
<span style="color: #859900; font-weight: bold;">end</span><span style="color: #d33682; font-style: italic;">;</span>
v
idx <span style="color: #d33682; font-style: italic;">=</span> [<span style="color: #6c71c4; font-weight: bold;">1</span> <span style="color: #6c71c4; font-weight: bold;">8</span> <span style="color: #6c71c4; font-weight: bold;">9</span> <span style="color: #6c71c4; font-weight: bold;">10</span>]<span style="color: #d33682; font-style: italic;">;</span>
<span style="color: #859900; font-weight: bold;">for</span> i<span style="color: #d33682; font-style: italic;">=</span>idx<span style="color: #d33682; font-style: italic;">,</span>
  v(i) <span style="color: #d33682; font-style: italic;">=</span> <span style="color: #6c71c4; font-weight: bold;">1000</span> <span style="color: #d33682; font-style: italic;">+</span> i<span style="color: #d33682; font-style: italic;">;</span>
<span style="color: #859900; font-weight: bold;">end</span><span style="color: #d33682; font-style: italic;">;</span>
v
</pre>
</div>
<pre class="example">
v =

   0   0   0   0   0   0   0   0   0   0
v =

     2     4     8    16    32    64   128     0     0     0
v =

   1001      4      8     16     32     64    128   1008   1009   1010
</pre>


<p>
While loop
</p>
<div class="org-src-container">
<pre class="src src-octave">i <span style="color: #d33682; font-style: italic;">=</span> <span style="color: #6c71c4; font-weight: bold;">1</span><span style="color: #d33682; font-style: italic;">;</span>
<span style="color: #859900; font-weight: bold;">while</span> i <span style="color: #d33682; font-style: italic;">&lt;=</span> <span style="color: #6c71c4; font-weight: bold;">3</span><span style="color: #d33682; font-style: italic;">,</span>
  v(i) <span style="color: #d33682; font-style: italic;">=</span> <span style="color: #6c71c4; font-weight: bold;">999</span><span style="color: #d33682; font-style: italic;">;</span>
  i <span style="color: #d33682; font-style: italic;">=</span> i<span style="color: #d33682; font-style: italic;">+</span><span style="color: #6c71c4; font-weight: bold;">1</span><span style="color: #d33682; font-style: italic;">;</span>
<span style="color: #859900; font-weight: bold;">end</span><span style="color: #d33682; font-style: italic;">;</span>
v
i <span style="color: #d33682; font-style: italic;">=</span> <span style="color: #6c71c4; font-weight: bold;">1</span><span style="color: #d33682; font-style: italic;">;</span>
<span style="color: #859900; font-weight: bold;">while</span> true
  <span style="color: #859900; font-weight: bold;">if</span> i <span style="color: #d33682; font-style: italic;">&gt;</span> <span style="color: #6c71c4; font-weight: bold;">4</span><span style="color: #d33682; font-style: italic;">,</span>
    <span style="color: #859900; font-weight: bold;">break</span><span style="color: #d33682; font-style: italic;">;</span>
  <span style="color: #859900; font-weight: bold;">end</span><span style="color: #d33682; font-style: italic;">;</span>
  disp(i)<span style="color: #d33682; font-style: italic;">;</span>
  i <span style="color: #d33682; font-style: italic;">=</span> i<span style="color: #d33682; font-style: italic;">+</span><span style="color: #6c71c4; font-weight: bold;">1</span><span style="color: #d33682; font-style: italic;">;</span>
<span style="color: #859900; font-weight: bold;">end</span><span style="color: #d33682; font-style: italic;">;</span>
</pre>
</div>
<pre class="example">
v =

    999    999    999     16     32     64    128   1008   1009   1010
1
2
3
4
</pre>
</div>
</div>

<div id="outline-container-org8d05cba" class="outline-4">
<h4 id="org8d05cba"><span class="section-number-4">3.9.2.</span> Functions</h4>
<div class="outline-text-4" id="text-3-9-2">
<p>
Functions are stored in files. The name of the file must match the name of the function that the file exports. The file can have other internal functions, but they are not available outside of the file itself.
</p>
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #b58900; font-style: italic;">ls</span> ./squareAndAdd.m
<span style="color: #b58900; font-style: italic;">cat</span> ./squareAndAdd.m
</pre>
</div>
<pre class="example">
./squareAndAdd.m
function ret_val = squareAndAdd(x, y)
  ret_val = square(x) + y;

function sq = square(x)
  sq = x^2;
</pre>


<p>
If we are in the same directory, as the <code>.m</code> file, then we can just call the function in these files. We can use the octave function <code>addpath('/path/to/file.m')</code> to make the definitions available even if we are not in the same directory
</p>
<div class="org-src-container">
<pre class="src src-octave">pwd
squareAndAdd(<span style="color: #6c71c4; font-weight: bold;">2</span><span style="color: #d33682; font-style: italic;">,</span> <span style="color: #6c71c4; font-weight: bold;">1</span>)
square(<span style="color: #6c71c4; font-weight: bold;">4</span>) <span style="color: #96A7A9; font-style: italic;">% this will fail</span>
</pre>
</div>
<pre class="example">
ans = /home/claudio/repos/machine-learning/week2
ans = 5
error: 'square' undefined near line 1, column 1

The 'square' function belongs to the signal package from Octave Forge
which seems to not be installed in your system.

Please read &lt;https://www.octave.org/missing.html&gt; to learn how you can
contribute missing functionality.
</pre>


<p>
Let&rsquo;s create a function <code>costFunctionJ(X, y, Theta)</code> that receives the design matrix, targets, and a candidate for Theta, and returns the associated cost.
</p>
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #b58900; font-style: italic;">ls</span> ./costFunctionJ.m
<span style="color: #b58900; font-style: italic;">cat</span> ./costFunctionJ.m
</pre>
</div>
<pre class="example" id="org1204a38">
./costFunctionJ.m
function J = costFunctionJ(X, y, Theta)
  %% X     : is the "design matrix" (column of ones left-attached to matrix of features)
  %% y     : is the array of targets
  %% Theta : the array of parameters to evaluate

  m = size(X,1);               % number of training examples.
  h = X*Theta;                 % array of hypothesis. Each hyp. is T0 + T1*x1 + T2*x2 + T3*x3...
  sqErrors = (h-y).^2;         % squared errors.
  J = 1/(2*m) * sum(sqErrors); % half of the average of the addition of all sqErrors.
</pre>

<p>
Let&rsquo;s use the function with some \(\Theta\)
</p>
<div class="org-src-container">
<pre class="src src-octave">data <span style="color: #d33682; font-style: italic;">=</span> load(<span style="color: #2aa198;">'my_dataset.txt'</span>)
X <span style="color: #d33682; font-style: italic;">=</span> [  ones(size(data<span style="color: #d33682; font-style: italic;">,</span><span style="color: #6c71c4; font-weight: bold;">1</span>)<span style="color: #d33682; font-style: italic;">,</span><span style="color: #6c71c4; font-weight: bold;">1</span>)  <span style="color: #d33682; font-style: italic;">,</span>  data(<span style="color: #d33682; font-style: italic;">:,</span><span style="color: #6c71c4; font-weight: bold;">1</span><span style="color: #d33682; font-style: italic;">:</span>(end<span style="color: #d33682; font-style: italic;">-</span><span style="color: #6c71c4; font-weight: bold;">1</span>))  ]<span style="color: #d33682; font-style: italic;">;</span>
y <span style="color: #d33682; font-style: italic;">=</span> data(<span style="color: #d33682; font-style: italic;">:,</span>end)<span style="color: #d33682; font-style: italic;">;</span>
Theta <span style="color: #d33682; font-style: italic;">=</span> [<span style="color: #d33682; font-style: italic;">-</span><span style="color: #6c71c4; font-weight: bold;">7000</span> <span style="color: #6c71c4; font-weight: bold;">5</span> <span style="color: #d33682; font-style: italic;">-</span><span style="color: #6c71c4; font-weight: bold;">100</span> <span style="color: #6c71c4; font-weight: bold;">90</span> <span style="color: #6c71c4; font-weight: bold;">0</span>] <span style="color: #96A7A9; font-style: italic;">% taken out of my ass</span>
cost <span style="color: #d33682; font-style: italic;">=</span> costFunctionJ(X<span style="color: #d33682; font-style: italic;">,</span> y<span style="color: #d33682; font-style: italic;">,</span> Theta<span style="color: #d33682; font-style: italic;">'</span>)
</pre>
</div>
<pre class="example" id="org9cf204a">
data =

   2104      5      1     45    460
   1416      3      2     40    232
   1534      3      2     30    315
    852      2      1     36    178
Theta =

  -7000      5   -100     90      0
cost = 2.0401e+06
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf20c6e4" class="outline-3">
<h3 id="orgf20c6e4"><span class="section-number-3">3.10.</span> Vectorization</h3>
<div class="outline-text-3" id="text-3-10">
<p>
Yada yada&#x2026; Use the vector and matrix primitives that Octave offers rather than traversing with your own hand-made for-loops, etc. That is much faster.
</p>
</div>
</div>
</div>
<div id="outline-container-org04dfe73" class="outline-2">
<h2 id="org04dfe73"><span class="section-number-2">4.</span> Programming Assignment</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org1713a78" class="outline-3">
<h3 id="org1713a78"><span class="section-number-3">4.1.</span> Simple Octave function</h3>
<div class="outline-text-3" id="text-4-1">
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #b58900; font-style: italic;">cat</span> warmUpExercise.m.orig
</pre>
</div>
<pre class="example" id="org824a0cf">
function A = warmUpExercise()
%WARMUPEXERCISE Example function in octave
%   A = WARMUPEXERCISE() is an example function that returns the 5x5 identity matrix
A = [];
% ============= YOUR CODE HERE ==============
% Instructions: Return the 5x5 identity matrix
%               In octave, we return values by defining which variables
%               represent the return values (at the top of the file)
%               and then set them accordingly.
% ===========================================
end
</pre>

<div class="org-src-container">
<pre class="src src-bash"><span style="color: #b58900; font-style: italic;">cat</span> warmUpExercise.m
</pre>
</div>
<pre class="example">
function A = warmUpExercise()
  % WARMUPEXERCISE Example function in octave
  % A = WARMUPEXERCISE() is an example function that returns the 5x5 identity matrix
  A = eye(5);
end
</pre>


<p>
Run the warm-up exercise.
</p>
<div class="org-src-container">
<pre class="src src-octave">warmUpExercise
</pre>
</div>
<pre class="example">
ans =

Diagonal Matrix

   1   0   0   0   0
   0   1   0   0   0
   0   0   1   0   0
   0   0   0   1   0
   0   0   0   0   1
</pre>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1" role="doc-backlink">1</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">
\(J(\Theta^{\star})\) small, not necessarily the smallest. That would be to find the global minima (wich is cool, but usually unrealistic).
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<p class="author">Author: Claudio Parra</p>
<p class="date">Created: 2023-07-20 Thu 16:43</p>
</div>
</body>
</html>